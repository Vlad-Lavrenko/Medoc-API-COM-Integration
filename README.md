# Medoc API COM Integration

REST API —Å–µ—Ä–≤—ñ—Å –¥–ª—è —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó –∑ —Å–∏—Å—Ç–µ–º–æ—é M.E.Doc —á–µ—Ä–µ–∑ COM-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å. –°–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑ Windows Service (REST API), Desktop UI –¥–ª—è –∫–µ—Ä—É–≤–∞–Ω–Ω—è —Ç–∞ —Å–ø—ñ–ª—å–Ω–æ—ó –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏.

## üéØ –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è

–ü—Ä–æ–µ–∫—Ç —Å—Ç–≤–æ—Ä–µ–Ω–∏–π –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó —Ä–æ–±–æ—Ç–∏ –∑ M.E.Doc —á–µ—Ä–µ–∑ REST API:
- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ –æ–±—Ä–æ–±–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤
- –ï–ª–µ–∫—Ç—Ä–æ–Ω–Ω–µ –ø—ñ–¥–ø–∏—Å–∞–Ω–Ω—è
- –í—ñ–¥–ø—Ä–∞–≤–∫–∞ –¥–æ –∫–æ–Ω—Ç—Ä–æ–ª—é—é—á–∏—Ö –æ—Ä–≥–∞–Ω—ñ–≤ (–î–ü–° –£–∫—Ä–∞—ó–Ω–∏)
- –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞–Ω—É —Å–ª—É–∂–±–∏
- –ö–µ—Ä—É–≤–∞–Ω–Ω—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è–º–∏ —á–µ—Ä–µ–∑ Desktop UI

## üèóÔ∏è –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É

```
Medoc-API-COM-Integration/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ Common/                         # –°–ø—ñ–ª—å–Ω–∞ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Configuration/              # –°–∏—Å—Ç–µ–º–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SettingsManager.cs      # –ú–µ–Ω–µ–¥–∂–µ—Ä —á–∏—Ç–∞–Ω–Ω—è/–∑–∞–ø–∏—Å—É –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ SettingsValidator.cs    # –í–∞–ª—ñ–¥–∞—Ü—ñ—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Constants/                  # –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏ –¥–æ–¥–∞—Ç–∫—É
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Logging/                    # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó Serilog
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Models/                     # –°–ø—ñ–ª—å–Ω—ñ –º–æ–¥–µ–ª—ñ –¥–∞–Ω–∏—Ö
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ ApiResponse.cs          # –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–æ–≤–∞–Ω–∞ –æ–±–≥–æ—Ä—Ç–∫–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π API
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ AppSettings.cs          # –ú–æ–¥–µ–ª—å –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å —Å–ª—É–∂–±–∏
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ ServiceInfo.cs          # –ú–æ–¥–µ–ª—ñ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ —Å–ª—É–∂–±—É
‚îÇ   ‚îú‚îÄ‚îÄ Service/                        # REST API Windows Service
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Endpoints/                  # Minimal API endpoints
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Extensions/                 # Extension –º–µ—Ç–æ–¥–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Middleware/                 # ASP.NET Core middleware
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Services/                   # –ë—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ appsettings.json            # –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Program.cs                  # –¢–æ—á–∫–∞ –≤—Ö–æ–¥—É
‚îÇ   ‚îú‚îÄ‚îÄ DesktopUI/                      # WPF Desktop –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Converters/                 # XAML Value Converters
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Models/                     # –ú–æ–¥–µ–ª—ñ UI (ServiceStatus, LogEntry)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Services/                   # –°–µ—Ä–≤—ñ—Å–∏ UI
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ IServiceController.cs   # –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∫–µ—Ä—É–≤–∞–Ω–Ω—è —Å–ª—É–∂–±–æ—é
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ WindowsServiceController.cs # –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è ServiceController
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ILogReader.cs           # –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å —á–∏—Ç–∞–Ω–Ω—è –ª–æ–≥—ñ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ LogReaderService.cs     # –ß–∏—Ç–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –ª–æ–≥—ñ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ViewModels/                 # MVVM ViewModels
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ MainViewModel.cs
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DashboardViewModel.cs
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ SettingsViewModel.cs
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Views/                      # XAML –≤—ñ–∫–Ω–∞ —Ç–∞ –∫–æ–Ω—Ç—Ä–æ–ª–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ MainWindow.xaml         # –ì–æ–ª–æ–≤–Ω–µ –≤—ñ–∫–Ω–æ –∑ –≤–∫–ª–∞–¥–∫–∞–º–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Pages/
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ DashboardPage.xaml  # –°–ª—É–∂–±–∞ + –õ–æ–≥–∏
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ SettingsPage.xaml   # –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ App.xaml                    # Application entry point
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ app.manifest                # UAC elevation manifest
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ DesktopUI.csproj
‚îÇ   ‚îî‚îÄ‚îÄ Service.Tests/                  # Unit-—Ç–µ—Å—Ç–∏
‚îÇ       ‚îî‚îÄ‚îÄ Unit/
‚îî‚îÄ‚îÄ logs/                               # –õ–æ–≥–∏ (–≥–µ–Ω–µ—Ä—É—é—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ)
```

## üöÄ –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—á–Ω–∏–π —Å—Ç–µ–∫

### –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞
- **.NET 10.0** ‚Äî –æ—Å—Ç–∞–Ω–Ω—è –≤–µ—Ä—Å—ñ—è .NET –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏
- **C# 13** ‚Äî —Å—É—á–∞—Å–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –º–æ–≤–∏

### REST API Service
- **ASP.NET Core Minimal API** ‚Äî –ª–µ–≥–∫–æ–≤–∞–∂–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥ –¥–æ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è API
- **OpenAPI 3.1** ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç –æ–ø–∏—Å—É REST API
- **Scalar 2.12** ‚Äî —Å—É—á–∞—Å–Ω–∏–π —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π UI –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó API

### Desktop UI
- **WPF (.NET 10)** ‚Äî Windows Presentation Foundation
- **MaterialDesignThemes 5.3** ‚Äî Material Design 3 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏
- **CommunityToolkit.Mvvm 8.4** ‚Äî MVVM helpers (ObservableObject, RelayCommand)
- **Microsoft.Extensions.DependencyInjection 10.0** ‚Äî DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
- **Serilog.Extensions.Logging** ‚Äî —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è Serilog –∑ ILogger

### –õ–æ–≥—É–≤–∞–Ω–Ω—è
- **Serilog 4.2** ‚Äî structured logging
- **Serilog.Sinks.File** ‚Äî –∑–∞–ø–∏—Å —É —Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏ –∑ —Ä–æ—Ç–∞—Ü—ñ—î—é
- **Serilog.Sinks.Console** ‚Äî –≤–∏–≤—ñ–¥ —É –∫–æ–Ω—Å–æ–ª—å
- **Serilog.Sinks.Debug** ‚Äî –≤–∏–≤—ñ–¥ —É Debug Output –≤—ñ–∫–Ω–æ VS
- **Enrichers** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É (machine name, thread ID, process ID)

### –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è
- **JSON –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è** ‚Äî –≥–Ω—É—á–∫–∞ —Å–∏—Å—Ç–µ–º–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó
- **SettingsManager** ‚Äî —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–µ –∫–µ—Ä—É–≤–∞–Ω–Ω—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è–º–∏
- **Data Annotations** ‚Äî –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å

### –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è
- **xUnit 2.9** ‚Äî —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è unit-—Ç–µ—Å—Ç—ñ–≤
- **NSubstitute 5.3** ‚Äî mocking library
- **FluentAssertions 7.0** ‚Äî –≤–∏—Ä–∞–∑–Ω—ñ assertions

## üìã –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª

### REST API Endpoints

#### `GET /health`
–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞–Ω—É —Å–ª—É–∂–±–∏

**–í—ñ–¥–ø–æ–≤—ñ–¥—å:**
```json
{
  "result": "ok",
  "errorMsg": "",
  "data": {
    "status": "Healthy",
    "checkedAt": "2026-02-19T21:00:00Z",
    "details": {
      "uptime": 123.45
    }
  }
}
```

#### `GET /info`
–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Å–ª—É–∂–±—É (–≤–µ—Ä—Å—ñ—è, —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ, —Ö–æ—Å—Ç, —á–∞—Å –∑–∞–ø—É—Å–∫—É)

**–í—ñ–¥–ø–æ–≤—ñ–¥—å:**
```json
{
  "result": "ok",
  "errorMsg": "",
  "data": {
    "service": "Service",
    "version": "1.0.0.0",
    "environment": "Development",
    "hostName": "DESKTOP-PC",
    "startedAt": "2026-02-19T21:00:00Z"
  }
}
```

### –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–æ–≤–∞–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π

**–£—Å–ø—ñ—à–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å:**
```json
{
  "result": "ok",
  "errorMsg": "",
  "data": { }
}
```

**–í—ñ–¥–ø–æ–≤—ñ–¥—å –∑ –ø–æ–º–∏–ª–∫–æ—é:**
```json
{
  "result": "error",
  "errorMsg": "–û–ø–∏—Å –ø–æ–º–∏–ª–∫–∏",
  "data": null
}
```

### Desktop UI

#### –í–∫–ª–∞–¥–∫–∞ "–°–ª—É–∂–±–∞ —Ç–∞ –õ–æ–≥–∏"
- üü¢/üî¥ –Ü–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ—Ç–æ—á–Ω–æ–≥–æ —Å—Ç–∞–Ω—É —Å–ª—É–∂–±–∏ (–∞–≤—Ç–æ–æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–∂–Ω—ñ 5 —Å–µ–∫)
- –ö–Ω–æ–ø–∫–∏ –∫–µ—Ä—É–≤–∞–Ω–Ω—è: **–ó–∞–ø—É—Å—Ç–∏—Ç–∏ / –ó—É–ø–∏–Ω–∏—Ç–∏ / –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ / –û–Ω–æ–≤–∏—Ç–∏**
- –ö–Ω–æ–ø–∫–∞ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è **Scalar API Documentation** —É –±—Ä–∞—É–∑–µ—Ä—ñ
- –¢–∞–±–ª–∏—Ü—è –ª–æ–≥—ñ–≤ –∑ –∫–æ–ª—å–æ—Ä–æ–≤–∏–º –º–∞—Ä–∫—É–≤–∞–Ω–Ω—è–º —Ä—ñ–≤–Ω—ñ–≤ (VRB/DBG/INF/WRN/ERR/FTL)
- –ö–Ω–æ–ø–∫–∏ **–û–Ω–æ–≤–∏—Ç–∏** —Ç–∞ **–û—á–∏—Å—Ç–∏—Ç–∏** –ª–æ–≥–∏

#### –í–∫–ª–∞–¥–∫–∞ "–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è"
- –ö–Ω–æ–ø–∫–∏ **–ü—Ä–æ—á–∏—Ç–∞—Ç–∏** (–∑ —Ñ–∞–π–ª—É) —Ç–∞ **–ó–∞–ø–∏—Å–∞—Ç–∏** (—É —Ñ–∞–π–ª)
- **–ì—Ä—É–ø–∞ API**: –∞–¥—Ä–µ—Å–∞, –ø–æ—Ä—Ç, –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∞ –ø–æ–≤–Ω–∞ URL
- **–ì—Ä—É–ø–∞ –õ–æ–≥—É–≤–∞–Ω–Ω—è**: –≤–∏–±—ñ—Ä –º—ñ–Ω—ñ–º–∞–ª—å–Ω–æ–≥–æ —Ä—ñ–≤–Ω—è –ª–æ–≥—É–≤–∞–Ω–Ω—è –∑ ComboBox
- –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ–π–Ω–∏–π –±–ª–æ–∫ –∑ —à–ª—è—Ö–æ–º –¥–æ —Ñ–∞–π–ª—É –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å

## ‚öôÔ∏è –°–∏—Å—Ç–µ–º–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å

### –§–∞–π–ª–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó

–ü—Ä–æ–µ–∫—Ç –ø—ñ–¥—Ç—Ä–∏–º—É—î –¥–≤–æ—Ä—ñ–≤–Ω–µ–≤—É —Å–∏—Å—Ç–µ–º—É –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å:

1. **appsettings.json** ‚Äî –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º (–≤ –ø—Ä–æ–µ–∫—Ç—ñ)
2. **C:\ProgramData\MedocIntegration\settings.json** ‚Äî –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

### –î–æ—Å—Ç—É–ø–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

#### API –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
- **Address** ‚Äî –∞–¥—Ä–µ—Å–∞ –¥–ª—è –ø—Ä–æ—Å–ª—É—Ö–æ–≤—É–≤–∞–Ω–Ω—è
  - `http://localhost` ‚Äî —Ç—ñ–ª—å–∫–∏ –ª–æ–∫–∞–ª—å–Ω–∏–π –¥–æ—Å—Ç—É–ø
  - `http://0.0.0.0` ‚Äî –¥–æ—Å—Ç—É–ø –∑ —É—Å—ñ—Ö –º–µ—Ä–µ–∂–µ–≤–∏—Ö —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ–≤
- **Port** ‚Äî –ø–æ—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞ (1-65535)

#### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ª–æ–≥—É–≤–∞–Ω–Ω—è
- **MinimumLevel** ‚Äî –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π —Ä—ñ–≤–µ–Ω—å –ª–æ–≥—É–≤–∞–Ω–Ω—è
  - `Verbose` ‚Üí `Debug` ‚Üí `Information` ‚Üí `Warning` ‚Üí `Error` ‚Üí `Fatal`

### –ü—Ä–∏–∫–ª–∞–¥ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó

**appsettings.json:**
```json
{
  "AppSettings": {
    "Api": {
      "Address": "http://localhost",
      "Port": 5000
    },
    "Logging": {
      "MinimumLevel": "Information"
    },
    "UserSettingsPath": "C:\\ProgramData\\MedocIntegration\\settings.json"
  }
}
```

**C:\ProgramData\MedocIntegration\settings.json:**
```json
{
  "api": {
    "address": "http://0.0.0.0",
    "port": 8080
  },
  "logging": {
    "minimumLevel": "Warning"
  }
}
```

## üîß –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –∑–∞–ø—É—Å–∫

### –í–∏–º–æ–≥–∏
- Windows 10/11 –∞–±–æ Windows Server 2019+
- .NET 10.0 Runtime
- Visual Studio 2022 17.13+ (–¥–ª—è —Ä–æ–∑—Ä–æ–±–∫–∏)

### –ó–∞–ø—É—Å–∫ —É —Ä–µ–∂–∏–º—ñ —Ä–æ–∑—Ä–æ–±–∫–∏

1. –ö–ª–æ–Ω—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π:
```bash
git clone https://github.com/Vlad-Lavrenko/Medoc-API-COM-Integration.git
cd Medoc-API-COM-Integration
```

2. –í—ñ–¥–∫—Ä–∏–π—Ç–µ solution —É Visual Studio 2022:
```
Medoc API COM Integration.slnx
```

3. –í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å Multiple Startup Projects:
   - `Service` ‚Üí **Start**
   - `DesktopUI` ‚Üí **Start**

4. –ó–∞–ø—É—Å—Ç—ñ—Ç—å (`F5`)

5. –í—ñ–¥–∫—Ä–∏—î—Ç—å—Å—è Desktop UI —Ç–∞ —Å—Ç–∞—Ä—Ç—É—î REST API —Å–µ—Ä–≤–µ—Ä.
   Scalar –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –¥–æ—Å—Ç—É–ø–Ω–∞ –∑–∞ –∞–¥—Ä–µ—Å–æ—é:
```
http://localhost:5000/scalar/v1
```

### –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —è–∫ Windows Service

```powershell
# –ü—É–±–ª—ñ–∫–∞—Ü—ñ—è –ø—Ä–æ–µ–∫—Ç—É
dotnet publish src/Service/Service.csproj -c Release -o C:\Services\MedocAPI

# –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–ª—É–∂–±–∏
sc create MedocIntegrationService binPath="C:\Services\MedocAPI\Service.exe"

# –ó–∞–ø—É—Å–∫ —Å–ª—É–∂–±–∏
sc start MedocIntegrationService
```

### –ó–º—ñ–Ω–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å

–í–∞—Ä—ñ–∞–Ω—Ç 1 ‚Äî —á–µ—Ä–µ–∑ **Desktop UI** (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ):
1. –ó–∞–ø—É—Å—Ç—ñ—Ç—å `DesktopUI.exe` –≤—ñ–¥ —ñ–º–µ–Ω—ñ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞
2. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ –≤–∫–ª–∞–¥–∫—É **–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è**
3. –ó–º—ñ–Ω—ñ—Ç—å –ø–æ—Ç—Ä—ñ–±–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è
4. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **–ó–∞–ø–∏—Å–∞—Ç–∏**
5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç—ñ—Ç—å —Å–ª—É–∂–±—É —á–µ—Ä–µ–∑ –≤–∫–ª–∞–¥–∫—É **–°–ª—É–∂–±–∞ —Ç–∞ –õ–æ–≥–∏**

–í–∞—Ä—ñ–∞–Ω—Ç 2 ‚Äî –≤—Ä—É—á–Ω—É:
1. –í—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ `C:\ProgramData\MedocIntegration\settings.json`
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç—ñ—Ç—å —Å–ª—É–∂–±—É:
```powershell
sc stop MedocIntegrationService
sc start MedocIntegrationService
```

## üìä –õ–æ–≥—É–≤–∞–Ω–Ω—è

–õ–æ–≥–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —É –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó `logs/` –∑ —Ä–æ—Ç–∞—Ü—ñ—î—é —â–æ–¥–Ω—è:

```
logs/
‚îú‚îÄ‚îÄ medocservice-20260219.log
‚îú‚îÄ‚îÄ medocservice-20260220.log
‚îî‚îÄ‚îÄ ...
```

**–§–æ—Ä–º–∞—Ç –ª–æ–≥—É:**
```
2026-02-19 21:00:15.123 +02:00 [INF] [MedocIntegration.Service.Program] Starting Medoc API COM Integration - Service
2026-02-19 21:00:16.456 +02:00 [INF] HTTP GET /health responded 200 in 12.3456ms
```

**–û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ —Ä–æ—Ç–∞—Ü—ñ—è —â–æ–¥–Ω—è
- –ó–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –ª–æ–≥—ñ–≤ –ø—Ä–æ—Ç—è–≥–æ–º 30 –¥–Ω—ñ–≤
- Shared access ‚Äî –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å —á–∏—Ç–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ —ñ–Ω—à–∏–º–∏ –ø—Ä–æ—Ü–µ—Å–∞–º–∏ (Desktop UI)
- Structured logging –¥–ª—è –ª–µ–≥–∫–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥—É
- –î–∏–Ω–∞–º—ñ—á–Ω–∞ –∑–º—ñ–Ω–∞ —Ä—ñ–≤–Ω—è —á–µ—Ä–µ–∑ —Ñ–∞–π–ª –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

–ó–∞–ø—É—Å–∫ unit-—Ç–µ—Å—Ç—ñ–≤:

```bash
dotnet test src/Service.Tests/Service.Tests.csproj
```

**–ü–æ–∫—Ä–∏—Ç—Ç—è —Ç–µ—Å—Ç–∞–º–∏:**
- ‚úÖ HealthService
- ‚úÖ InfoService
- ‚úÖ Endpoints (—á–µ—Ä–µ–∑ integration —Ç–µ—Å—Ç–∏)

## üîê –ë–µ–∑–ø–µ–∫–∞

- –ì–ª–æ–±–∞–ª—å–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –≤–∏–∫–ª—é—á–µ–Ω—å —á–µ—Ä–µ–∑ middleware
- –°—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö –∑–∞–ø–∏—Ç—ñ–≤
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–æ–≤–∞–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫–∏
- –í–∞–ª—ñ–¥–∞—Ü—ñ—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
- UAC elevation –¥–ª—è Desktop UI (–≤–∏–º–∞–≥–∞—î –ø—Ä–∞–≤–∞ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞)

## üéØ Roadmap

- [x] REST API –∑ OpenAPI/Scalar –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—î—é
- [x] Structured logging —á–µ—Ä–µ–∑ Serilog
- [x] –°–∏—Å—Ç–µ–º–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å (JSON)
- [x] Desktop UI (WPF + Material Design 3)
- [x] –ö–µ—Ä—É–≤–∞–Ω–Ω—è Windows Service —á–µ—Ä–µ–∑ UI
- [x] –ü–µ—Ä–µ–≥–ª—è–¥ –ª–æ–≥—ñ–≤ —É —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ
- [ ] COM —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ M.E.Doc
- [ ] Endpoints –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤
- [ ] –ï–ª–µ–∫—Ç—Ä–æ–Ω–Ω–µ –ø—ñ–¥–ø–∏—Å–∞–Ω–Ω—è —á–µ—Ä–µ–∑ –ï–¶–ü
- [ ] –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è —Ç–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è API

## üìù –õ—ñ—Ü–µ–Ω–∑—ñ—è

–ü—Ä–∏–≤–∞—Ç–Ω–∏–π –ø—Ä–æ–µ–∫—Ç.

## üë®‚Äçüíª –ê–≤—Ç–æ—Ä

**Vlad Lavrenko**
- GitHub: [@Vlad-Lavrenko](https://github.com/Vlad-Lavrenko)
- Email: vlad.lavrenko@gmail.com

## üîó –ö–æ—Ä–∏—Å–Ω—ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è

- [ASP.NET Core Documentation](https://docs.microsoft.com/aspnet/core)
- [Serilog Documentation](https://serilog.net/)
- [Scalar API Documentation](https://scalar.com/)
- [Material Design In XAML](https://materialdesigninxaml.net/)
- [CommunityToolkit.Mvvm](https://learn.microsoft.com/dotnet/communitytoolkit/mvvm/)
- [M.E.Doc Official Site](https://medoc.ua/)
