# Medoc API COM Integration

REST API —Å–µ—Ä–≤—ñ—Å –¥–ª—è —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó –∑ —Å–∏—Å—Ç–µ–º–æ—é M.E.Doc —á–µ—Ä–µ–∑ COM-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å. –ü—Ä–∞—Ü—é—î —è–∫ Windows Service —ñ –Ω–∞–¥–∞—î —Å—É—á–∞—Å–Ω–∏–π REST API –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—î—é.

## üéØ –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è

–ü—Ä–æ—î–∫—Ç —Å—Ç–≤–æ—Ä–µ–Ω–∏–π –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó —Ä–æ–±–æ—Ç–∏ –∑ M.E.Doc —á–µ—Ä–µ–∑ REST API:
- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞ –æ–±—Ä–æ–±–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤
- –ï–ª–µ–∫—Ç—Ä–æ–Ω–Ω–µ –ø—ñ–¥–ø–∏—Å–∞–Ω–Ω—è
- –í—ñ–¥–ø—Ä–∞–≤–∫–∞ –¥–æ –∫–æ–Ω—Ç—Ä–æ–ª—é—é—á–∏—Ö –æ—Ä–≥–∞–Ω—ñ–≤ (–î–ü–° –£–∫—Ä–∞—ó–Ω–∏)
- –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞–Ω—É —Å–ª—É–∂–±–∏

## üèóÔ∏è –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

```
Medoc-API-COM-Integration/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ Common/                         # –°–ø—ñ–ª—å–Ω–∞ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Constants/                  # –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏ –¥–æ–¥–∞—Ç–∫—É
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Logging/                    # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó Serilog
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Models/                     # –°–ø—ñ–ª—å–Ω—ñ –º–æ–¥–µ–ª—ñ –¥–∞–Ω–∏—Ö
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ ApiResponse.cs          # –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–æ–≤–∞–Ω–∞ –æ–±–≥–æ—Ä—Ç–∫–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π API
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ ServiceInfo.cs          # –ú–æ–¥–µ–ª—ñ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ —Å–ª—É–∂–±—É
‚îÇ   ‚îú‚îÄ‚îÄ Service/                        # REST API Windows Service
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Endpoints/                  # Minimal API endpoints
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Extensions/                 # Extension –º–µ—Ç–æ–¥–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Middleware/                 # ASP.NET Core middleware
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Services/                   # –ë—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Program.cs                  # –¢–æ—á–∫–∞ –≤—Ö–æ–¥—É
‚îÇ   ‚îî‚îÄ‚îÄ Service.Tests/                  # Unit-—Ç–µ—Å—Ç–∏
‚îÇ       ‚îî‚îÄ‚îÄ Unit/                       # Unit —Ç–µ—Å—Ç–∏ –¥–ª—è —Å–µ—Ä–≤—ñ—Å—ñ–≤
‚îî‚îÄ‚îÄ logs/                               # –õ–æ–≥–∏ (–≥–µ–Ω–µ—Ä—É—é—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ)
```

## üöÄ –¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—á–Ω–∏–π —Å—Ç–µ–∫

### –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞
- **.NET 10.0** ‚Äî –æ—Å—Ç–∞–Ω–Ω—è –≤–µ—Ä—Å—ñ—è .NET –ø–ª–∞—Ç—Ñ–æ—Ä–º–∏
- **C# 13** ‚Äî —Å—É—á–∞—Å–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –º–æ–≤–∏
- **ASP.NET Core Minimal API** ‚Äî –ª–µ–≥–∫–æ–≤–∞–≥–∏–π –ø—ñ–¥—Ö—ñ–¥ –¥–æ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è API

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è API
- **OpenAPI 3.1** ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç –æ–ø–∏—Å—É REST API
- **Scalar 2.12** ‚Äî —Å—É—á–∞—Å–Ω–∏–π —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π UI –¥–ª—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó API

### –õ–æ–≥—É–≤–∞–Ω–Ω—è
- **Serilog 4.2** ‚Äî structured logging
- **Serilog.Sinks.File** ‚Äî –∑–∞–ø–∏—Å —É —Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏ –∑ —Ä–æ—Ç–∞—Ü—ñ—î—é
- **Serilog.Sinks.Console** ‚Äî –≤–∏–≤—ñ–¥ —É –∫–æ–Ω—Å–æ–ª—å
- **Enrichers** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É (machine name, thread ID, process ID)

### –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è
- **xUnit 2.9** ‚Äî —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è unit-—Ç–µ—Å—Ç—ñ–≤
- **NSubstitute 5.3** ‚Äî mocking library
- **FluentAssertions 7.0** ‚Äî –≤–∏—Ä–∞–∑–Ω—ñ assertions

### Deployment
- **Windows Service** ‚Äî —Ñ–æ–Ω–æ–≤–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Å–ª—É–∂–±–∏
- **Serilog Request Logging** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è HTTP –∑–∞–ø–∏—Ç—ñ–≤

## üìã –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª

### API Endpoints

#### `GET /health`
–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞–Ω—É —Å–ª—É–∂–±–∏

**–í—ñ–¥–ø–æ–≤—ñ–¥—å:**
```json
{
  "result": "ok",
  "errorMsg": "",
  "data": {
    "status": "Healthy",
    "checkedAt": "2026-02-12T19:20:00Z",
    "details": {
      "uptime": 123.45
    }
  }
}
```

#### `GET /info`
–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Å–ª—É–∂–±—É (–≤–µ—Ä—Å—ñ—è, —Å–µ—Ä–µ–¥–æ–≤–∏—â–µ, —Ö–æ—Å—Ç, —á–∞—Å –∑–∞–ø—É—Å–∫—É)

**–í—ñ–¥–ø–æ–≤—ñ–¥—å:**
```json
{
  "result": "ok",
  "errorMsg": "",
  "data": {
    "service": "Service",
    "version": "1.0.0.0",
    "environment": "Development",
    "hostName": "DESKTOP-PC",
    "startedAt": "2026-02-12T19:15:00Z"
  }
}
```

### –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–æ–≤–∞–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π

–£—Å—ñ endpoint'–∏ –ø–æ–≤–µ—Ä—Ç–∞—é—Ç—å –æ–¥–Ω–∞–∫–æ–≤–∏–π —Ñ–æ—Ä–º–∞—Ç:

**–£—Å–ø—ñ—à–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å:**
```json
{
  "result": "ok",
  "errorMsg": "",
  "data": { }
}
```

**–í—ñ–¥–ø–æ–≤—ñ–¥—å –∑ –ø–æ–º–∏–ª–∫–æ—é:**
```json
{
  "result": "error",
  "errorMsg": "–û–ø–∏—Å –ø–æ–º–∏–ª–∫–∏",
  "data": null
}
```

## üîß –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–∞ –∑–∞–ø—É—Å–∫

### –í–∏–º–æ–≥–∏
- Windows 10/11 –∞–±–æ Windows Server 2019+
- .NET 10.0 Runtime
- Visual Studio 2022 17.13+ (–¥–ª—è —Ä–æ–∑—Ä–æ–±–∫–∏)

### –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º—ñ —Ä–æ–∑—Ä–æ–±–∫–∏

1. –ö–ª–æ–Ω—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π:
```bash
git clone https://github.com/Vlad-Lavrenko/Medoc-API-COM-Integration.git
cd Medoc-API-COM-Integration
```

2. –í—ñ–¥–∫—Ä–∏–π—Ç–µ solution —É Visual Studio 2022:
```
Medoc API COM Integration.slnx
```

3. –ó–∞–ø—É—Å—Ç—ñ—Ç—å –ø—Ä–æ—î–∫—Ç Service (F5)

4. –í—ñ–¥–∫—Ä–∏–π—Ç–µ Scalar UI:
```
http://localhost:5000/scalar/v1
```

### –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —è–∫ Windows Service

```powershell
# –ü—É–±–ª—ñ–∫–∞—Ü—ñ—è –ø—Ä–æ—î–∫—Ç—É
dotnet publish src/Service/Service.csproj -c Release -o C:\Services\MedocAPI

# –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–ª—É–∂–±–∏
sc create MedocIntegrationService binPath="C:\Services\MedocAPI\Service.exe"

# –ó–∞–ø—É—Å–∫ —Å–ª—É–∂–±–∏
sc start MedocIntegrationService
```

## üìä –õ–æ–≥—É–≤–∞–Ω–Ω—è

–õ–æ–≥–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —É –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó `logs/` –∑ —Ä–æ—Ç–∞—Ü—ñ—î—é —â–æ–¥–Ω—è:

```
logs/
‚îú‚îÄ‚îÄ medocservice-20260212.log
‚îú‚îÄ‚îÄ medocservice-20260213.log
‚îî‚îÄ‚îÄ ...
```

**–§–æ—Ä–º–∞—Ç –ª–æ–≥—É:**
```
2026-02-12 21:20:15.123 +02:00 [INF] [MedocIntegration.Service.Program] Starting Medoc API COM Integration - MedocService
2026-02-12 21:20:16.456 +02:00 [INF] HTTP GET /health responded 200 in 12.3456ms
```

**–û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ —Ä–æ—Ç–∞—Ü—ñ—è —â–æ–¥–Ω—è
- –ó–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –ª–æ–≥—ñ–≤ –ø—Ä–æ—Ç—è–≥–æ–º 30 –¥–Ω—ñ–≤
- Shared access ‚Äî –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å —á–∏—Ç–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ —ñ–Ω—à–∏–º–∏ –ø—Ä–æ—Ü–µ—Å–∞–º–∏
- Structured logging –¥–ª—è –ª–µ–≥–∫–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥—É

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

–ó–∞–ø—É—Å–∫ unit-—Ç–µ—Å—Ç—ñ–≤:

```bash
dotnet test src/Service.Tests/Service.Tests.csproj
```

**–ü–æ–∫—Ä–∏—Ç—Ç—è —Ç–µ—Å—Ç–∞–º–∏:**
- ‚úÖ HealthService
- ‚úÖ InfoService
- ‚úÖ Endpoints (—á–µ—Ä–µ–∑ integration —Ç–µ—Å—Ç–∏)

## üîê –ë–µ–∑–ø–µ–∫–∞

- –ì–ª–æ–±–∞–ª—å–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –≤–∏–∫–ª—é—á–µ–Ω—å —á–µ—Ä–µ–∑ middleware
- –°—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö –∑–∞–ø–∏—Ç—ñ–≤
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–æ–≤–∞–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫–∏

## üéØ Roadmap

- [ ] COM —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ M.E.Doc
- [ ] Endpoints –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤
- [ ] –ï–ª–µ–∫—Ç—Ä–æ–Ω–Ω–µ –ø—ñ–¥–ø–∏—Å–∞–Ω–Ω—è —á–µ—Ä–µ–∑ –ï–¶–ü
- [ ] Desktop UI –¥–ª—è –∫–µ—Ä—É–≤–∞–Ω–Ω—è —Å–ª—É–∂–±–æ—é
- [ ] –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è —á–µ—Ä–µ–∑ appsettings.json
- [ ] –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è —Ç–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è API

## üìù –õ—ñ—Ü–µ–Ω–∑—ñ—è

–ü—Ä–∏–≤–∞—Ç–Ω–∏–π –ø—Ä–æ—î–∫—Ç.

## üë®‚Äçüíª –ê–≤—Ç–æ—Ä

**Vlad Lavrenko**
- GitHub: [@Vlad-Lavrenko](https://github.com/Vlad-Lavrenko)
- Email: vlad.lavrenko@gmail.com

## üîó –ö–æ—Ä–∏—Å–Ω—ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è

- [ASP.NET Core Documentation](https://docs.microsoft.com/aspnet/core)
- [Serilog Documentation](https://serilog.net/)
- [Scalar API Documentation](https://scalar.com/)
- [M.E.Doc Official Site](https://medoc.ua/)
